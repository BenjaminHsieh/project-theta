\subsection{Model Diagnostics}
By using a linear regression model for calculating the loss and gain $\beta $ 
values in the neural (BOLD) signals, we have made the following underlying 
assumptions:
\begin{enumerate}
    \item Normailty of errors
    \item Homoscedasticity (constant variance) or errors  
    \item Linearity of relationship between the explanatory and response
    \item Statistical independence of errors   
    \item All voxels and all subjects follow the same linear model. 
\end{enumerate}
The first four assumption can be motivated by using the residuals as a proxy
for the errors since the errors are unobservable. Here we check the first 
three assumptions by following the standard regression diagnostics plots and 
analysis. The fourth condition, checking for independence of errors, is 
equivalent to checking that no correlation exists between consecutive errors 
in our time series structure. A simple explanation is given in 
\textit{Simplifications of Model}, so it is leaved out here. For the fifth 
assumption, it may that there are some observations/conditions that do not 
obey the linear model. The methods used to detect these usual observations is 
further discussed in \textit{Outlier Detection}, so it will be left out here. 

\subsubsection{Linearity and Constant Variance}
The residual versus fitted values plot \ref{fig:residual_vs_fitted} is a 
standard plot for observing constant variance of errors and potential deviations
from linearity

\begin{figure}[ht]
\centering
\includegraphics[scale=0.5]{figures/res_fitted}  
\caption{Subject 2 Residual vs Fitted Values for voxel 40000, position 
coordinate (18,24,16) across time}
\label{fig:residual_vs_fitted}
\end{figure}

From the figure we can see that the residuals seem to have a constant variance
about zero with good spread, which is what we hoped to expect. This suggests 
homoscedasticity and satisfies the assumption of model. 

\subsubsection{Normality}
Normality of the errors is checked by checking the normality of the residuals. 
The normal qq-plot (Quantile-Quantile Plot) \ref{fig:qqplot} shows quantiles
of the sorted residuals of subject 2 voxel coordinate (18,24,16) accross time
against the normal theoretical quantiles. Ideally, the relationship should be 
linear. Here we can see that the normality assumption is reasonable. In 
practice, this makes sense because we expect the accross-time changes/errors 
of estimates for a sigle voxel to be close to normally distributed given our 
large sample size (about 717 time points). For a formal test of normality, we 
may choose to further explore the kurtosis, skew, and Shapiroâ€“Wilk's normality
test. 

\begin{figure}[ht]
\centering
\includegraphics[scale=0.5]{figures/qqplot}  
\caption{Subject 2 Normal QQ plot of the residuals for 40000, position 
coordinate (18,24,16) voxel.}
\label{fig:qqplot}
\end{figure}



